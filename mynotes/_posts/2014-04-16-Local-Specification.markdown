---
layout: post
title:  "Local Specification for Codeec"
date:   2014-04-16 10:55:24
categories: Research Notes
---

Our goal is to describe a specification language that can only express such
consistency assertions that can be *locally checked and enforced without
coordination* (Coordination-free). For example, total order of all operations
can neither be locally checked nor enforced without coordination. As another
example, total order on visible operations,

<div>
\[
visTotal = \forall a,b. \lambda x. vis(a,x) \wedge vis(b,x) \Rightarrow vis(a,b)
\]
</div>

can be locally checked but not enforced; $a$ and $b$ are actions that
correspond to completed operations, whose visibility information can be queried
but not enforced. Now, the question is can we restrict the specification
language such that only coordination-free specifications can be written down.

# Local specification language

<div>
\[
\newcommand{\ALT}{~|~}
\newcommand{\spec}{\overline{\forall a}. \phi \Rightarrow \psi}
\newcommand{\cf}[1]{CoordFree(#1)}
\begin{array}{rcl}
a,b,x  & \in & Action \\
lspec  & :=  &  \spec \\
\phi   & :=  & True \ALT vis(a,b) \ALT so(a,b) \ALT inVis(a) \ALT inSo(a) \ALT \phi \odot \phi \\
\psi   & :=  & inVis(a) \ALT \psi \odot \psi \\
\odot  & :=  & \wedge \ALT \vee \\
\end{array}
\]
</div>

The new constructs are $inVis(a)$ and $inSo(a)$ which are equivalent to
$vis(a,x)$ and $so(a,x)$ where $x$ is the action potentially generated by the
operation under focus.

## Examples

Let us look at examples of specifications that can be written down using this
language.

<div>
\begin{array}{rl}
\text{Read my writes :} & \forall a. inSo(a) \Rightarrow inVis(a) \\
\text{Monotonic writes :} & \forall a,b. so(a,b) \wedge inVis(b) \Rightarrow inVis(a) \\
\text{Monotonic reads :} & \forall a,b. vis(a,b) \wedge inSo(b) \Rightarrow inVis(a) \\
\text{Causal visibility :} & \forall a,b. vis(a,b) \wedge inVis(b) \Rightarrow inVis(a)
\end{array}
</div>

# Coordination Freedom Analysis

Let $k(x)$ indicate that $x$ is known. We want to know whether a specification
of the form $\spec$ is coordination free (locally checked and enforced without
coordination). To answer this, we will utilize $\cf{spec}$ which holds for
specifications that are coordination free. Of course, we assume that the
specification does not introduce logical inconsistencies. For example, the
following are logically inconsistent specifications:

* $\forall a. True \Rightarrow vis(a,a)$ - visibility is irreflexive.
* $\forall a,b. so(a,b) \wedge so(b,a) \Rightarrow inVis(a)$ - session order is total.
* $\forall a,b. inSo(a) \wedge vis (b,a) \Rightarrow inVis(b)$ - happens-before is acyclic.


